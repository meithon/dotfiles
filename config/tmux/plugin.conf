# vim: set ft=tmux 

# bootstrap tpm
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

# NOTE: <prefix> + I to install plugins
# Plugin manager

set -g @plugin 'tmux-plugins/tpm'
set -g @tmux-window-switcher-key-binding 'C-g'
set -g @tmux-window-switcher-width '50%'
set -g @tmux-window-switcher-height '90%'


set -g @plugin 'b0o/tmux-autoreload'
set -g @plugin 'meithon/tmux-session-popup'
set -g @session_switcher_widget_mode dots
set -g @session_switcher_next_key C-M-"'"
set -g @session_switcher_prev_key C-M-"\\;"
set -g @session_status_mode dots
# set -g status-right "#{b:pane_current_path} | #{@session_status_format} | %H:%M"

# ------------------------------------------------------------------------------------------
#  extract text from the terminal
# ------------------------------------------------------------------------------------------
# set -g @plugin 'laktak/extrakto'
# # set -g @extrakto_split_size "15"
# # set -g @extrakto_clip_tool "xsel --input --cl@extrakto_popup_sizeipboard" # works better for nvim
# set -g @extrakto_copy_key "tab"      # use tab to copy to clipboard
# set -g @extrakto_insert_key "enter"  # use enter to insert selection
# set -g @extrakto_fzf_unset_default_opts "true"  # keep our custom FZF_DEFAULT_OPTS
# set -g @extrakto_fzf_header "i c f g" # for small screens shorten the fzf header
#
# set -g @extrakto_popup_size '120,20'
#

# set -g status-right "#{E:@catppuccin_status_application}"
# set -agF status-right "#{E:@catppuccin_status_cpu}"
# set -ag status-right "#{E:@catppuccin_status_session}"
# set -ag status-right "#{E:@catppuccin_status_uptime}"
# set -agF status-right "#{E:@catppuccin_status_battery}"

# set -g status-right "#{E:@catppuccin_status_application}"
# set-option -g status-right "#[fg=colour255,bg=colour241] #(tmux list-sessions | awk -v current=\"$(tmux display-message -p '#S')\" '{gsub(/:.*$/,\"\"); if ($1 == current) {printf \"#[fg=orange]‚óè#[fg=default] \"} else {printf \"‚óè\"}}')"
# set -agF status-right "#{E:@catppuccin_status_kube}"

# set -g @plugin 'kiyoon/treemux'
# set -g @treemux-tree-nvim-init-file '~/.tmux/plugins/treemux/configs/treemux_init.lua'
# set -g @treemux-tree 'e'


# ------------------------------------------------------------------------------------------
#  pick screen url, commit, digetst, etc
# ------------------------------------------------------------------------------------------
# set -g @plugin 'Morantron/tmux-fingers'
# set -g @fingers-key F

# set -g @plugin 'pawel-wiejacha/tmux-picker'
# set -g PICKER_KEY 'F'

# ------------------------------------------------------------------------------------------
#  yank to system clipboard
# ------------------------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tmux-yank'

# set -g @plugin 'meithon/tmux-panehop'
# set -g @tmux_panehop_key 'j'


# ------------------------------------------------------------------------------------------
#  easy-motion
# ------------------------------------------------------------------------------------------
# set -g @plugin 'IngoMeyer441/tmux-easy-motion'
# set -g @easy-motion-prefix "Space"
# set -g @easy-motion-auto-begin-selection "true"



# source-file ~/.config/zsh/plugin/tmux.zsh
# bind-key -r "C-j" run-shell 'tmux-switch'
# FIXME: not working
# set -g @plugin 'olimorris/tmux-pomodoro-plus'
# # set -g @pomodoro_toggle 'm' 
# set -g status-right "#{pomodoro_status}"


# set -g @plugin 'ddzero2c/tmux-easymotion'


# ------------------------------------------------------------------------------------------
#  Removed Plugins
# ------------------------------------------------------------------------------------------
# I wanan not use vim keybind at tmux
# set -g @plugin 'christoomey/vim-tmux-navigator'
# Replaced by tmux-sessionx
# set -g @plugin 'joshmedeski/t-smart-tmux-session-manager'
# set -g @plugin 'tmux-plugins/tmux-yank'
#

# ------------------------------------------------------------------------------------------
#  yank like a easy-motion
# ------------------------------------------------------------------------------------------
# FIXME: not working
# set -g @plugin 'fcsonline/tmux-thumbs'

set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'
set -g @plugin 'mskelton/tmux-last' # <prefix>t

# A set of tmux options that should be acceptable to everyone.
set -g @plugin 'tmux-plugins/tmux-sensible'

# ------------------------------------------------------------------------------------------
#  Session management
# ------------------------------------------------------------------------------------------
set -g @plugin 'omerxx/tmux-sessionx'

# ------------------------------------------------------------------------------------------
#  session management
# ------------------------------------------------------------------------------------------
set -g @plugin 'sturob/tmux-teleport'

set -g @plugin 'b0o/tmux-autoreload'
set -g @tmux-autoreload-configs '~/.tmux.conf,~/dotfiles/config/tmux/keybind.conf,~/dotfiles/config/tmux/option.conf,~/dotfiles/config/tmux/plugin.conf,~/dotfiles/config/tmux/tmux.conf'
set-option -g @tmux-autoreload-entrypoints '~/.tmux.conf'

# ------------------------------------------------------------------------------------------
#  Theme
# ------------------------------------------------------------------------------------------
set -g @plugin 'catppuccin/tmux'
# run ~/.tmux/plugins/tmux/catppuccin.tmux
# set -g @catppuccin_flavour 'macchiato' # latte, frappe, macchiato, mocha
# set -g @catppuccin_window_left_separator "‚ñà"
# set -g @catppuccin_window_right_separator "ÓÇ¥¬†"
# set -g @catppuccin_window_middle_separator "‚ñà "
set -g status-right-length 100

# set -g status-left-length 100
# set -g status-left ""
# set -g status-right "#{E:@catppuccin_status_application}"
# set -agF status-right "#{E:@catppuccin_status_cpu}"
# set -ag status-right "#{E:@catppuccin_status_session}"
# set -ag status-right "#{E:@catppuccin_status_uptime}"
# set -agF status-right "#{E:@catppuccin_status_battery}"

set -g @plugin 'l-lin/tmux-window-switcher'

# Zoxide integration for session creation

bind-key C-M-g display-popup -E -h 80% -w 60% "zoxide query -i | xargs -I {} tmux new-session -d -s '{}' -c '{}' && tmux switch-client -t '{}'"


# bind -n C-M-m run-shell "sesh connect \"$(
#   sesh list -t --icons | fzf-tmux -p 80%,70% \
#     --no-sort --ansi --border-label ' sesh ' --prompt '‚ö°  ' \
#     --header '  ^a all ^t tmux ^g configs ^x zoxide ^d tmux kill ^f find' \
#     --bind 'tab:down,btab:up' \
#     --bind 'ctrl-a:change-prompt(‚ö°  )+reload(sesh list --icons)' \
#     --bind 'ctrl-t:change-prompt(ü™ü  )+reload(sesh list -t --icons)' \
#     --bind 'ctrl-g:change-prompt(‚öôÔ∏è  )+reload(sesh list -c --icons)' \
#     --bind 'ctrl-x:change-prompt(üìÅ  )+reload(sesh list -z --icons)' \
#     --bind 'ctrl-f:change-prompt(üîé  )+reload(fd -H -d 2 -t d -E .Trash . ~)' \
#     --bind 'ctrl-d:execute(tmux kill-session -t {2..})+change-prompt(‚ö°  )+reload(sesh list --icons)' \
#     --preview-window 'right:55%' \
#     --preview 'sesh preview {}'
# )\""


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
